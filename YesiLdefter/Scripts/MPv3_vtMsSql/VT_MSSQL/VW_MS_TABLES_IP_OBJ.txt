



CREATE VIEW [dbo].[VW_MS_TABLES_IP_OBJ]  
AS
 (

 -- EKRANLARDA KULLANILAN IP LER
   SELECT 
     'LAYOUT'        LKP_OBJ
   , L.MODUL_CODE    LKP_MODUL_CODE
   , L.MASTER_CODE   LKP_MASTER_CODE
   , L.LAYOUT_CODE   LKP_ITEM_CODE
   , L.TABLEIPCODE   LKP_TABLEIPCODE
   , L.TABLEIPCODE2  LKP_TABLEIPCODE2
   FROM MS_LAYOUT L
   WHERE L.LAYOUT_TYPE <> 'menu' 
   AND ( 
         (L.TABLEIPCODE  IS NOT NULL AND L.TABLEIPCODE <> '') 
      OR (L.TABLEIPCODE2 IS NOT NULL AND L.TABLEIPCODE2 <> '')
   )
  
   UNION ALL
  
   -- MENU DEKİ PROP_NAVIGATOR İÇİNDE KULLANILAN IP LER
   SELECT 
     'MENU'          LKP_OBJ  
   , M.MODUL_CODE    LKP_MODUL_CODE
   , M.MASTER_CODE   LKP_MASTER_CODE
   , M.ITEM_CODE     LKP_ITEM_CODE  
   , X.TABLEIPCODE   LKP_TABLEIPCODE
   , ''              LKP_TABLEIPCODE2
   FROM MS_ITEMS M
      LEFT OUTER JOIN 
         (
           SELECT TABLE_CODE + '.' + IP_CODE TABLEIPCODE FROM MS_TABLES_IP 
         ) X ON ( X.TABLEIPCODE <> '')

   WHERE M.PROP_NAVIGATOR LIKE '%' + X.TABLEIPCODE +'%'
   
 ) -- VW END
