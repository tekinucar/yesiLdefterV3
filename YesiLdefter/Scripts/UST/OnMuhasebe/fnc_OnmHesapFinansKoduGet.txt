/*CreateFunction*/

CREATE FUNCTION [dbo].[fnc_OnmHesapFinansKoduGet](
 @FirmId int 
,@UstGrupTipiId smallInt 
,@AnaGrupTipiId smallInt 
,@kacHane smallInt 
,@curId bigint
)  
RETURNS varchar(50)   
AS 
BEGIN  
    Declare @ret varchar(50);  
	Declare @xCount int

    if ((@kacHane = null) or (@kacHane = 0))
	    set @kacHane = 10

    set @xCount = @kacHane

    select @ret = replicate('0', @xCount - len(count(hf.Id)) ) + convert(varchar(10), count(hf.Id)) 
    from [dbo].[OnmHesapFinans] as hf
    Where hf.FirmId = @FirmId
    and   hf.UstGrupTipiId = @UstGrupTipiId
    and   hf.AnaGrupTipiId = @AnaGrupTipiId
	and   hf.Id <= @curId;

    IF (@ret IS NULL) 
        SET @ret = '000';  

    RETURN @ret;  
END

/*CreateFunctionEnd*/


