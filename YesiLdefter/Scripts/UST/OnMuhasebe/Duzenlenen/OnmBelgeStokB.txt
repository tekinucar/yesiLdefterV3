
/*CreateTable*/

begin transaction

 create table OnmBelgeStokB
 (

   Id                 Int IDENTITY(1,1) NOT NULL, 
   ParentId           Int       not null, /* default 0 */
   FirmId             Int       not null,
   IsActive           Bit       not null, /* default : 1 = active, 0 = not active */ 
   IsPaid             Bit       not null, /* default : 0 = ödenmedi,  1 = Ödendi */  
   IsCommit           Bit       not null, /* default : 0 = Muh. işlenmedi, 1 = Muh. İşlendi */  
   IsLock             Bit           null, /* default : 0 = Açık, 1 = Kilitli  */

   -- belge tip bilgileri
   -- 10
   GCTipiId           SmallInt      null, /* 0 = etkisiz, 1 = Giriş Hareketi, 2 = Çıkış Hareketi */
   BelgeTipiId        SmallInt      null, /*   */
   KaynakTipiId       SmallInt      null, /* 1. kağıt, 2. elektronik belge */
   SebepTipiId        SmallInt      null, /*   */
   TuruTipiId         SmallInt      null, /* 1. Sipariş, 2. İrsaliye, 3. Fatura   */


   --fatura bilgileri
   -- 20 Belge Hakkında
   BelgeTarihi        Date          null,
   BelgeSaati         VarChar(8)    null,
   BelgeSeri          nVarChar(5)   null,
   BelgeNo            nVarChar(50)  null,
   -- 30
   GIBEttn            nVarChar(50)  null,
   GIBFaturaTipiId    SmallInt      null,
   
   -- 40
   VadeGun            SmallInt      null,  
   SonOdemeTarihi     Date          null, 
   GecerlilikTarihi   Date          null, /* sigortanın son tarihi */
   Aciklama           nVarChar(100) null,
   -- 50
   ParaTipiId         nVarChar(3)   null, /* belgenin para birimi */
   DovizYeriId        SmallInt      null,
   DovizKuru          Numeric(12,5) null,

   --cari bilgisi
   -- 60
   CariTipiId         SmallInt      null, /* 1. Gerçek Kişi, 2. Özel Firma, 3. Kamu Kurumu */
   TalepId            Int           null,
   CariId             Int           null,
   CariTcVkNo         nVarChar(11)  null,
   CariUnvan          nVarChar(100) null, /* cari hesabı yok ise */
   CariAdiSoyadi      nVarChar(100) null,

   -- 70
   CariAdresi         nVarChar(200) null,
   CariIlce           nVarChar(20)  null,
   CariIl             nVarChar(20)  null,
   CariTelefonu       nVarChar(15)  null,
   CariVergiDairesi   nVarChar(50)  null,
   VergiDairesiTipiId nVarChar(5)   null,
   FaturaAdresId      Int           null,
   TeslimatAdresId    Int           null,

   --sipariş bilgisi
   --irsaliye bilgisi
   --ökc bilgisi
   --alıcı bilgileri
   --alıcı adresi
   --

   -- 90
   KayitTarihi        Datetime      null, 

   -- Satırlar
   -- 100 
   IOKdvliToplamTutar Numeric(22,8)  null, /* BURASI SATIRLARDAKİ TUTARLAR */
   IskontoOrani       Numeric(12,8)  null,
   IskontoTutari      Numeric(22,8)  null,
   ISEkVergiTutari    Numeric(22,8)  null,
   ISKdvliToplamTutar Numeric(22,8)  null,
   
   ISKdv1Matrahi      Numeric(22,8)  null,
   ISKdv2Matrahi      Numeric(22,8)  null,
   ISKdv3Matrahi      Numeric(22,8)  null,
   ISKdv0Matrahi      Numeric(22,8)  null,
   
   -- FA : Fatura Altı
   -- 110
   FA1IskontoOrani    Numeric(12,8)  null,
   FA2IskontoOrani    Numeric(12,8)  null,
   FA3IskontoOrani    Numeric(12,8)  null,
   FA4IskontoOrani    Numeric(12,8)  null,
   -- 120
   FA1IskontoTutari   Numeric(22,8)  null,
   FA2IskontoTutari   Numeric(22,8)  null,
   FA3IskontoTutari   Numeric(22,8)  null,
   FA4IskontoTutari   Numeric(22,8)  null,
   -- 130
   FAIskontoOrani     Numeric(12,8)  null,
   FAIskontoTutari    Numeric(22,8)  null,    
   dFAIskontoTutari   Numeric(22,8)  null,   
   KdvsizToplam       Numeric(22,8)  null, /* KdvMatrahiToplam  olmaz, kdv%0 olan satırlarda olabilir */
   dKdvsizToplam      Numeric(22,8)  null,
   
   -- FA sonraki Matrah ve Tutarlar
   -- 140
   NoKdv              Bit            null, /* 1 ise kdv uygulaması yok */
   Kdv1Matrahi        Numeric(22,8)  null,
   Kdv1Tutari         Numeric(22,8)  null,
   Kdv2Matrahi        Numeric(22,8)  null,
   Kdv2Tutari         Numeric(22,8)  null,
   Kdv3Matrahi        Numeric(22,8)  null,
   Kdv3Tutari         Numeric(22,8)  null,
   Kdv0Matrahi        Numeric(22,8)  null,
   -- 150
   ToplamKdvMatrahi   Numeric(22,8)  null, /* Toplam Matrah %1,8,18 olan satırların toplamı */
   ToplamKdvTutari    Numeric(22,8)  null, /* Toplam Kdv Tutarı */
   -- 160
   TevkifatTutari     Numeric(22,8)  null, /*  (( kdv_tutarı / 10 payda ) X 7 pay )       tutarı */
   HesaplananKdv      Numeric(22,8)  null, /* KdvTutariToplam - TevkifatTutari */
   -- 170
   GenelToplam        Numeric(22,8)  null,
   dGenelToplam       Numeric(22,8)  null,

   constraint		pk_OnmBelgeStokB primary key (Id)
 )

 create index X_OnmBelgeStokB01 on OnmBelgeStokB (FirmId)
 create index X_OnmBelgeStokB02 on OnmBelgeStokB (GCTipiId)
 create index X_OnmBelgeStokB03 on OnmBelgeStokB (BelgeTipiId)
 create index X_OnmBelgeStokB04 on OnmBelgeStokB (KaynakTipiId)
 create index X_OnmBelgeStokB05 on OnmBelgeStokB (SebepTipiId)
 create index X_OnmBelgeStokB06 on OnmBelgeStokB (TuruTipiId)
 create index X_OnmBelgeStokB011 on OnmBelgeStokB (BelgeTarihi)
 create index X_OnmBelgeStokB012 on OnmBelgeStokB (KayitTarihi)
 create index X_OnmBelgeStokB013 on OnmBelgeStokB (TalepId)
 create index X_OnmBelgeStokB014 on OnmBelgeStokB (CariId)
 
commit transaction

/*CreateTableEnd*/



/*CreateLkpTable*/

begin transaction

-- ------------------------------------------------------- 
-- GCTipiId
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBGCTipi')
drop table [Lkp].[OnmBelgeStokBGCTipi]

create table [Lkp].[OnmBelgeStokBGCTipi]
(
   Id           Int Unique Not Null,
   GCTipi       nVarchar(50),
   GrupTipiId   SmallInt Null,

   constraint  pk_OnmBelgeStokBGCTipi primary key (Id)
)

INSERT INTO [Lkp].[OnmBelgeStokBGCTipi] (Id, GCTipi, GrupTipiId)
 VALUES 
  (0,   N'Stok Hareketsiz', 0),
  (1,   N'Stok Giriş', 1),
  (2,   N'Stok Çıkış', 1),
  (3,   N'Stok Sayım', 1)

  

-- ------------------------------------------------------- 
-- BelgeTipiId
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBBelgeTipi')
drop table [Lkp].[OnmBelgeStokBBelgeTipi]

create table [Lkp].[OnmBelgeStokBBelgeTipi]
(
   Id           Int Unique Not Null,
   BelgeTipi    nVarchar(50),
   GrupTipiId   SmallInt Null,

   constraint  pk_OnmBelgeStokBBelgeTipi primary key (Id)
)

DELETE FROM [Lkp].[OnmBelgeStokBBelgeTipi]
INSERT INTO [Lkp].[OnmBelgeStokBBelgeTipi] (Id, BelgeTipi, GrupTipiId)
 VALUES 
  (0,   N'Tanımsız', 0),
  (11,   N'Alınan sipariş', 1),
  (12,   N'Alım irsaliyesi', 1),
  (13,   N'Alım faturası', 1),
  (14,   N'Alım İADE faturası', 1),
  (15,   N'Alım İSKONTO faturası', 1),
  
  (21,   N'Verilen sipariş', 1),
  (22,   N'Satış irsaliyesi', 1),
  (23,   N'Satış faturası', 1),
  (24,   N'Satış İADE faturası', 1),
  (25,   N'Satış İSKONTO faturası', 1),

  (33,   N'Parkende satış', 1)

-- ------------------------------------------------------- 
-- KaynakTipiId
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBKaynakTipi')
drop table [Lkp].[OnmBelgeStokBKaynakTipi]

create table [Lkp].[OnmBelgeStokBKaynakTipi]
(
   Id           Int Unique Not Null,
   KaynakTipi   nVarchar(50),
   GrupTipiId   SmallInt Null,

   constraint  pk_OnmBelgeStokBKaynakTipi primary key (Id)
)


INSERT INTO [Lkp].[OnmBelgeStokBKaynakTipi] (Id, KaynakTipi, GrupTipiId)
 VALUES 
  (0,   N'Tanımsız', 0),
  (1,   N'e-devlet', 1),
  (2,   N'e-posta', 1),
  (3,   N'Kağıt', 1),
  (5,   N'Fax', 1),
  (7,   N'Diğer', 1)

-- ------------------------------------------------------- 
-- BelgeStokBSebepTipi
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBSebepTipi')
drop table [Lkp].[OnmBelgeStokBSebepTipi]

create table [Lkp].[OnmBelgeStokBSebepTipi]
(
   Id           Int Unique Not Null,
   SebepTipi    nVarchar(50),
   GrupTipiId   SmallInt Null,

   constraint  pk_OnmBelgeStokBSebepTipi primary key (Id)
)

INSERT INTO [Lkp].[OnmBelgeStokBSebepTipi] (Id, SebepTipi, GrupTipiId)
 VALUES 
  (0,     N'Tanımsız', 0),
  (153,   N'Ticari mal alımları', 1),
  (1501,  N'Üretimi için alımlar', 1),
  (1504,  N'Genel yön.için tüketim malz. alımı', 1),
  (1505,  N'Arge için mal alımı', 1),
  (25,    N'Maddi duran varlık alımı', 1),
  (600,   N'Yurt içi satış', 1)


-- ------------------------------------------------------- 
-- BelgeStokBTuruTipi
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBTuruTipi')
drop table [Lkp].[OnmBelgeStokBTuruTipi]

create table [Lkp].[OnmBelgeStokBTuruTipi]
(
   Id           Int Unique Not Null,
   TuruTipi     nVarchar(50),
   GrupTipiId   SmallInt Null,

   constraint  pk_OnmBelgeStokBTuruTipi primary key (Id)
)

INSERT INTO [Lkp].[OnmBelgeStokBTuruTipi] (Id, TuruTipi, GrupTipiId)
 VALUES 
  (0,     N'Tanımsız', 0),
  (1,     N'Sipariş', 1),
  (2,     N'İrsaliye', 1),
  (3,     N'Fatura', 1)


commit transaction

/*CreateLkpTable*/


/*
BelgeStokB

Alım, Alım İadesi, Alım İskontosu

Amaç    : Alım / Satış belgeleri
Türleri : İrsaliye, Fatura, Sipariş, Bağlı Ek belgeler



   BelgeTipiId        SmallInt      null, /*   */
   KaynakTipiId       SmallInt      null, /* 1. kağıt, 2. elektronik belge */
   SebepTipiId        SmallInt      null, /*   */

   BelgeTarihi        Date          null,
   BelgeSaati         VarChar(8)    null,
   BelgeSeri          nVarChar(5)   null,
   BelgeNo            nVarChar(50)  null,


*/



-- ------------------------------------------------------- 
-- ProfileIDType
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBProfileIDType')
drop table [Lkp].[OnmBelgeStokBProfileIDType]

create table [Lkp].[OnmBelgeStokBProfileIDType]
(
   Id              Varchar(20) Unique Not Null,
   IsActive        Bool                   null,
   ProfileIDType   nVarchar(40)           null,

   constraint  pk_OnmBelgeStokBProfileIDType primary key (Id)
)

INSERT INTO [Lkp].[OnmBelgeStokBProfileIDType] (Id, IsActive, ProfileIDType)
 VALUES 
  ('',                   1,   N'Tanımsız'),
  ('TICARIFATURA',       1,   N'Ticari Fatura'),
  ('TEMELFATURA',        1,   N'Temel Fatura'),
  ('IHRACAT',            1,   N'İhracat'),
  ('YOLCUBERABERFATURA', 1,   N'Yolcu Beraber Fatura')



-- ------------------------------------------------------- 
-- InvoiceTypeCode
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBInvoiceTypeCode')
drop table [Lkp].[OnmBelgeStokBInvoiceTypeCode]

create table [Lkp].[OnmBelgeStokBInvoiceTypeCode]
(
   Id                Varchar(20) Unique Not Null,
   IsActive          Bool                   null,
   InvoiceTypeCode   nVarchar(40)           null,

   constraint  pk_OnmBelgeStokBInvoiceTypeCode primary key (Id)
)

INSERT INTO [Lkp].[OnmBelgeStokBInvoiceTypeCode] (Id, IsActive,  InvoiceTypeCode)
 VALUES 
  ('',             1,   N'Tanımsız'),
  ('SATIS',        1,   N'Satış'), 
  ('IADE',         1,   N'İade'),
  ('ISTISNA',      1,   N'İstisna'),
  ('TEVKIFAT',     1,   N'Tevkifat'),
  ('OZELMATRAH',   1,   N'Özel Matrah'), 
  ('IHRACKAYITLI', 1,   N'İhraç Kayıtlı'),
  ('SGK',          1,   N'SGK')



-- ------------------------------------------------------- 
-- AccountingCostType
-- ------------------------------------------------------- 
IF EXISTS (Select * From sys.objects WHERE name = 'OnmBelgeStokBAccountingCostType')
drop table [Lkp].[OnmBelgeStokBAccountingCostType]

create table [Lkp].[OnmBelgeStokBAccountingCostType]
(
   Id                   Varchar(20) Unique Not Null,
   IsActive             Bool                   null,
   AccountingCostType   nVarchar(40)           null,

   constraint  pk_OnmBelgeStokBAccountingCostType primary key (Id)
)

INSERT INTO [Lkp].[OnmBelgeStokBAccountingCostType] (Id, IsActive,  AccountingCostType)
 VALUES 
  ('',             1,   N'Tanımsız'),
  ('SAGLIK_ECZ',   1,   N'Sağlık Eczane '), 
  ('SAGLIK_HAS',   1,   N'Sağlık Hastahane'), 
  ('SAGLIK_OPT',   1,   N'Sağlık Opt'), 
  ('SAGLIK_MED',   1,   N'Sağlık Medikal'), 
  ('ABONELIK',     1,   N'Abonelik'), 
  ('MAL_HIZMET',   1,   N'Mal, Hizmet'), 
  ('DIGER',        1,   N'Diğer')


